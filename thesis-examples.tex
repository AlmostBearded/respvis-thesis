\chapter{Usage}
\label{chap:Usage}

This chapter demonstrates how different responsive patterns can be achieved using the components provided by the various RespVis modules outlined in Chapter~\ref{chap:Modules}.
The \code{src/examples} directory of the RespVis library contains examples that show how the library can be used to create different kinds of charts with varying degrees of responsive configurations.
Even though users can compose custom charts out of low-level components like Series, Axes, and Legends, all examples in this chapter focus on creating responsive visualizations using high-level Chart Window Components.
These Chart Windows represent convenient interfaces that allow visualization authors to focus on responsive configuration rather than on laborious tasks like setting up a Chart's structure and handling the render processes of their components.

All examples provided by the RespVis library follow the same basic structure outlined in Listing~\ref{list:ExampleStructure}:

\begin{enumerate}

\item 
Import the RespVis CSS file \code{respvis.css}.
This file contains the necessary default styling applied on visualization elements rendered by the RespVis library.

\item
Import D3 and RespVis.
RespVis is a D3 extension library, and therefore the functionality of both libraries needs to be imported from either IIFE or ES modules to create visualizations with RespVis.

\item
Attach a \code{<div>} element to the element into which the Chart Window should be rendered.

\item
Bind a fully-initialized data object to the \code{<div>} element that represents the render configuration of the Chart Window.
This data object is usually created by deriving default properties from a partial object via one of the \code{chartWindowXData} functions.

\item
Attach a \code{resize} event listener to the \code{<div>} element.
This event listener should update the Chart Window's bound data object based on media queries and rerender it.
Theoretically, it is possible to use the actual viewport size in pixels for responsive configuration decisions, but it is strongly recommended to use media queries via the \code{window.matchMedia} function instead.
The usage of media queries allows a Chart's JavaScript configuration to be based on the same media queries that might be used for the CSS configuration of the same Chart.

\item
Render the Chart Window using the appropriate \code{chartWindowXRender} function.

\end{enumerate}

Since one of the core premises of RespVis is to enable the configuration of SVG-based visualizations with CSS, many responsive patterns can be implemented without JavaScript.
In general, everything that does not affect the content or behavior of a Chart should be handled in CSS, which includes configuring presentation attributes and the layout of laid-out elements.
Configuration changes that affect a Chart's content or behavior, like changing the visualized data, texts, or interaction mechanisms, still need to be applied in JavaScript.
Knowing what kind of configuration is better done in CSS or JavaScript is not immediately obvious and can be confusing to figure out for developers unfamiliar with RespVis.
There are plans to allow configuring even more in CSS, but this requires that data is also accessible there, which would cause a rather extensive refactoring and, therefore, will be considered for a future release of the library.

\section{Axes}
\label{sec:AxesUsage}

Axes are used to visualize the spatial mapping of abstract values by rendering abstract values as ticks at the spatial positions to which they are being mapped.
In addition to ticks, an Axis also contains an optional title and subtitle to describe the visualized data further.
Axis-related responsive patterns are of great significance because nearly every Chart includes Axes, and often improving the responsiveness of Axes alone can already lead to significant improvements in a user's experience.

Common issues that occur when decreasing the available space of Axes are overlapping tick labels and too long titles and subtitles.
These issues can be alleviated with the following responsive patterns that  can also be seen in Listing~\ref{list:AxisPatterns} and Figure~\ref{fig:AxisPatterns}:

\begin{itemize}

\item
Rotate tick labels.
One of the most effective ways to prevent tick labels from overlapping is rotating them by up to 90 degrees because all the available information is preserved and only presented differently.
Tick labels can be rotated by setting a rotation in the CSS \code{transform} property on their pivot container elements and modifying their CSS \code{text-anchor} property accordingly. 

\item
Simplify tick labels.
In some cases rotating tick labels may not be desired, or labels might still overlap after rotation.
The next best thing that can be done in these cases is to shorten tick labels if shorter textual representations exist.
The D3 Axis object used for rendering ticks is accessible via the \code{configureAxis} function property on an Axis' data object, and how individual tick labels are shortened is specified as a formatting callback set via the D3 Axis' \code{tickFormat} function.

\item
Remove ticks.
If neither rotation nor shortening of tick labels is applicable, the last thing that can be done is to reduce the number of ticks shown.
This can be achieved either via a D3 Axis' \code{ticks} or \code{tickValues} function, or by simply making ticks transparent via the CSS \code{opacity} property.
A D3 Axis' \code{ticks} function allows specifying the desired number of ticks that shall be rendered, and the D3 Axis' render function will decide how many ticks to create based on this number and other contributing factors.
The \code{tickValues} function of a D3 Axis allows for much more control than the \code{ticks} function because it is used to specify the exact abstract values for which ticks shall be rendered.

\item
Simplify title/subtitle.
Since Axes do not just contain ticks but also titles and subtitles, these should not be ignored when optimizing the responsiveness of Axes.
One of the things that can be done is to simplify titles/subtitles by specifying shorter textual representations via the \code{title} and \code{subtitle} properties on Axes' data objects.

\item
Relocate title/subtitle.
The titles and subtitles of Axes can be relocated by modifying the Axes' grid layouts via the CSS \code{grid-template} property. 

\item
Remove title/subtitle.
The titles and subtitles of Axes can be hidden by making them transparent via the CSS \code{opacity} property.

\end{itemize}

\section{Legends}
\label{sec:LegendsUsage}

Legends visualize the non-spatial mapping of abstract values such as mappings to colors, shapes, and sizes via labeled symbols and are needed in any visualization that uses such an encoding.
They are essential and frequently encountered parts of visualizations and, as such, must not be ignored when optimizing a visualization's responsiveness. 
Listing~\ref{list:LegendPatterns} shows how different responsive patterns can be implemented using RespVis Legends, and Figure~\ref{fig:LegendPatterns} displays the resulting Legend visualizations.
These patterns are:

\begin{itemize}

\item
Relocate Legend.
A Legend's position in its containing Chart can be controlled by directly modifying the Chart's grid layout via the CSS \code{grid-template} property, or by positioning the Legend at predefined \code{\"top\"}, \code{\"right\"}, \code{\"bottom\"}, and \code{\"left\"} positions via the \code{data-legend-position} attribute.

\item
Simplify title.
A Legend's title can be shortened by specifying a shorter textual representation for it via the \code{title} property on a Chart's data object.

\item
Remove title.
If the title can not be further shortened or if it does not convey too much important information, it can be hidden by making it transparent via the CSS \code{opacity} property.

\item
Simplify symbol labels.
If the symbol labels can be shortened, this can be done via the \code{labels} property on a Legend's data object.
This property allows the specification of the text content of all labels as an array of string values.

\item
Relocate labeled symbols.
Changing the layout of labeled symbols is one of the most effective responsive patterns applicable to Legends.
By default, labeled symbols are laid out using CSS Flexbox layouting.
Thus, whether labeled symbols are laid out horizontally or vertically can be controlled using the CSS \code{flex-direction} property on their container element.

\end{itemize}

\section{Bar Charts}
\label{sec:BarChartsUsage}

Bar Charts are used to compare categories associated with quantitative values by visualizing them as bars whose lengths depend on the quantitative dimension of the data.
In the case of Multi-Series Bar Charts like Grouped and Stacked Bar Charts, categories are further divided into subcategories associated with quantitative values and compared with one another rather than categories themselves.
Bars in Multi-Series Bar Charts are usually colored based on their subcategories which is why these Charts often include Legends to visualize this color encoding.

The different responsive patterns applicable to Bar Charts have already been discussed in Section~\ref{sec:BarChartExamples}, and the focus here lies on demonstrating their implementation using the Bar Chart Windows provided by RespVis.
Listing~\ref{list:BarChartPatterns} demonstrates how these patterns can be implemented and Figure~\ref{fig:BarChartPatterns} shows how they look in the resulting rendering.
In practice, the responsive patterns that can be applied to different variants of Bar Charts are very similar, which is why this section does not differentiate between them.
These patterns are:

\begin{itemize}

\item
Rescale Chart.
Scaling a Bar Chart to fit into the available space is done automatically by their render functions.
By default, Axes and Legends only take up necessary space, and the remaining space is filled with the Chart's draw area.
Bars and labels in this draw area are automatically scaled and positioned to fit into the allocated space.

\item
Reduce bar padding.
Reducing the paddings between bars frees up space that can be used by the bars themselves.
Paddings can be controlled via the \code{padding} function on the \code{categoryScale} property of a Bar Chart's data object. 

\item
Simplify bar labels.
When reducing the width of Bar Charts, bar labels could start overlapping one another, and it might be a good idea to shorten them, if possible. 
These labels can be configured using the \code{labels} property of a Bar Chart's data object.

\item
Remove bar labels.
An alternative to prevent bar labels from overlapping is to hide some or even all of them.
The best way of implementing this is to make the labels that should be hidden transparent via the CSS \code{opacity} property.

\item
Transpose Chart.
By default, Bar Charts are rendered with vertical bars, and transposing would make them horizontal.
Horizontal Bar Charts are better suited for narrow spaces because bar labels and the tick labels of the Axis representing categories are easier to place.
Furthermore, Horizontal Bar Charts are allowed to extend outside the visible viewport because vertical scrolling is strongly preferred over horizontal scrolling.
Bar Charts can be transposed by setting the \code{flipped} property on their data objects.

\item
Remove bars.
Sometimes it might be required to reduce the number of bars to maintain a good user experience.
Bars representing certain categories or subcategories can be hidden by declaring them as inactive via the \code{activeCategories} and \code{activeSubcategories} properties on a Bar Chart's data object.
Using these properties is easier than manually adapting the \code{categories}, \code{values}, \code{categoryScale}, and \code{valueScale} properties on the data object.
Furthermore, categories and subcategories that have been hidden via the \code{activeCategories} and \code{activeSubcategories} properties can also be unhidden by users via a Chart's Toolbar if they are interested in the additional data.  

\item
Apply Axis patterns.
Since Bar Charts usually contain two Axes to visualize the spatial mappings of categories and values, all responsive patterns mentioned in Section~\ref{sec:AxesUsage} should also be applied to Bar Charts.

\item
Apply Legend patterns.
For Multi-Series Bar Charts that contain Legends to visualize the color mapping of bars, the responsive patterns mentioned in Section~\ref{sec:LegendsUsage} should be applied.

\end{itemize}

\section{Line Charts}
\label{sec:LineChartsUsage}

\section{Point Charts}
\label{sec:PointChartsUsage}
